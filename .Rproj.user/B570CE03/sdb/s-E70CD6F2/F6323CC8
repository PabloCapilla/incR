{
    "contents" : "#' @title Data manupilation for incubation data analysis\n#' @description Preparing incubation time series for further analysis. \n#' Initial data manipulation.\n#' This function takes a data file containing a temporal series of temperature\n#' and adds all the extra variables needed to use\n#' further functions embedded in the incR package. \n#' It simply acommodates the data frame reformating dates, times and \n#' so on.\n#' @param data: raw data from incubation time series. This must include two columns with the\n#' following names:\n#' \\itemize{\n#'  \\item DATE - date and time collapsed in one columns, eg. \"dd/mm/yyyy hh:mm\". \n#'  Its format must be specified in \\emph{format} (see below).\n#'  \\item valueT - temperature values.\n#' }\n#' @param format: format for DATE as defined in the function \\emph{strptime}.   \n#' \\emph{incR_prep} assumes the DATE contains date and time, so choose\n#' its format accordingly.\n#' @param timezone: time zone for time calculations. See \\emph{strptime}\n#' documentation for more details.\n#' @return The original data frame with additional colunms for:\n#' \\enumerate{\n#' \\item index: a running number identifying every row in the data set.\n#' \\item time: time in DATE and \"hour\"\n#' \\item date: date in DATE and \"year\"\n#' \\item dec.time: time in decimal format\n#' \\item temp1 and temp2: differential temperatures defines as\n#' \\deqn{T[i] - T[i-1]} and  \\deqn{T[i] - T[i-2]}.\n#' }\n#' @examples\n#' NULL\n\nincR_prep <- function (data, date.format, timezone) \n{\n  # converting time and date into the right formats\n  t <- strptime(data$DATE, format=date.format, tz=timezone)\n  data$time <- strftime (t, format= \"%H:%M\")\n  data$date <- as.Date(format(data$t,\"%Y-%m-%d\"))\n  \n  # index for each row\n  data$index <- seq(1, to=length(data$valueT), by=1)\n  \n  # variables for hour and year\n  data$hour <- as.numeric(format (data$t, \"%H\"))\n  data$year <- as.numeric(format(data$t, \"%Y\")) \n  \n  # time in min decimals\n  tempo <- strftime(data$t, format= \"%H:%M\", tz=timezone)\n  data$dec.time <- sapply(strsplit(tempo,\":\"),\n                          function(x) {\n                            x <- as.numeric(x)\n                            x[1]+x[2]/60\n                          })\n  \n  # diferential temperatures\n  # loop to calculate t - (t-1) and -(t-2)\n  # t - t-1\n  loop1 <- length(data$valueT)\n  loop2 <- length(data$valueT)\n  data$temp1 <- NA\n  data$temp2 <- NA\n  \n  # differentialteperature order 1\n  for (i in 2:loop1) {\n    data$temp1[1] <- NA\n    data$temp1[i] <- data$valueT[i]-data$valueT[i-1]\n  }\n  \n  # differentialteperature order 2\n  for (i in 3:loop2) {\n    data$temp2[1:2] <- NA\n    data$temp2[i] <- data$valueT[i]-data$valueT[i-2]\n  }\n  \n  # new data frame with the name you want to have\n  return (data)\n  \n}\n",
    "created" : 1461151493249.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1069953549",
    "id" : "F6323CC8",
    "lastKnownWriteTime" : 1461151588,
    "path" : "D:/R development/incR/R/incR_prep.r",
    "project_path" : "R/incR_prep.r",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}